# Настройка подбора изображений для статей

## Что реализовано:

✅ **Три варианта получения изображений:**
1. **Оригинальное изображение** - извлекается из исходной статьи
2. **Изображение из Pexels** - поиск через бесплатный API
3. **Сгенерированное изображение** - через Kandinsky (Yandex Cloud)

✅ **Пользователь выбирает** нужное изображение из трех вариантов

✅ **При отправке в каналы** используется выбранное изображение

---

## Настройка Pexels API (опционально):

Если хотите использовать поиск через Pexels:

1. **Зарегистрируйтесь на Pexels.com:**
   - Перейдите на https://www.pexels.com/api/
   - Нажмите "Get Started"
   - Зарегистрируйтесь (бесплатно)

2. **Получите API ключ:**
   - После регистрации вы получите API ключ
   - Скопируйте его

3. **Добавьте в `Backend/BOT_TOKEN.env`:**
   ```env
   PEXELS_API_KEY=ваш_pexels_api_ключ
   ```

4. **Перезапустите бэкенд**

**Без API ключа Pexels:**
- Поиск через Pexels будет пропущен
- Будут доступны только оригинальное и сгенерированное изображения

---

## Настройка Kandinsky (Yandex Cloud):

Kandinsky уже настроен через ваш Yandex Cloud API ключ.

**Если генерация не работает:**
- Проверьте, что `YANDEX_CLOUD_API_KEY` есть в `Backend/BOT_TOKEN.env`
- Убедитесь, что у API ключа есть разрешения для работы с Vision API
- Проверьте логи бэкенда при генерации

---

## Как это работает:

1. **Пользователь вводит URL статьи** и выбирает стиль
2. **Бэкенд:**
   - Извлекает текст статьи
   - Рерайтит через Yandex Cloud
   - Получает три варианта изображений:
     - Извлекает из оригинальной статьи
     - Ищет через Pexels (если настроен)
     - Генерирует через Kandinsky
3. **Фронтенд показывает** все три варианта
4. **Пользователь выбирает** нужное изображение
5. **При отправке в каналы** используется выбранное изображение

---

## Структура ответа API:

```json
{
  "success": true,
  "rewritten_text": "...",
  "images": {
    "original": "https://example.com/image.jpg",
    "pexels": "https://images.pexels.com/...",
    "generated": "https://storage.yandexcloud.net/..."
  }
}
```

---

## Отправка в каналы:

При отправке статьи в Telegram каналы:
- Если выбрано изображение - отправляется как фото с подписью
- Если изображение не выбрано - отправляется только текст

---

## Возможные проблемы:

### 1. Изображение не извлекается из статьи
- Статья может не содержать изображений
- Изображения могут быть в формате, который не распознается
- **Решение:** Используйте другие варианты (Pexels или генерация)

### 2. Pexels API не работает
- Проверьте API ключ в `BOT_TOKEN.env`
- Проверьте лимиты запросов (200/час бесплатно)
- **Решение:** Без API ключа этот вариант просто не будет доступен

### 3. Генерация через Kandinsky не работает
- Проверьте логи бэкенда
- Убедитесь, что API ключ имеет нужные разрешения
- **Решение:** Используйте оригинальное или Pexels изображение

---

## Тестирование:

1. Введите URL статьи
2. Выберите стиль рерайта
3. Нажмите "Рерайт статьи"
4. Дождитесь загрузки (может занять время из-за генерации)
5. Выберите одно из трех изображений
6. Проверьте превью выбранного изображения
7. Отправьте в каналы - изображение должно прикрепиться

